name: Testing
on:
  push:
    branches:
      - demo-branch

jobs:
  Publish:
    runs-on: ubuntu-latest
    defaults:
      run:
        working-directory: /home/runner/work/demo
    steps:
    - name: use action/checkout@v2 
      uses: actions/checkout@v2
      
    - name: Setting up GitHub user
      run: |
        git config --global user.email "tmohansk@gmail.com"
        git config --global user.name "Mohan Sai"
        
    - name: Using GitHub Repo Secrets
      uses: fregante/setup-git-token@v1
      with:
        token: ${{ secrets.DEMO_SECRET }}
      
    - name: Cloning remote GitHub Repo
      run: |
        git clone https://github.com/fake-orgn/new.git
        
    - name: Copying files from present repo to remote repo
      run: cp -r demo/* new/
      
    - name: Adding the files to remote repo
      run: |
        cd new
        git add --all
    
    - name: Commiting the files to remote repo
      run: |
        cd new
        git commit -m "${{ github.event.head_commit.message }}"

      
